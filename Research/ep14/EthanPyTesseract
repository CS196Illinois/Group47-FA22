import cv2
import pytesseract
import os

# use opencv to read the text from the image
image = cv2.imread(os.path.join("Group47-FA22/Research/ep14/nutrition label 1 max crop.png"))
gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)
rawtext = pytesseract.image_to_string(gray, lang="eng").lower()

# isolate the ingredients section
colonIndex = rawtext.index(":")
periodIndex = rawtext[colonIndex:].index(".")
ingredientsOnly = rawtext[colonIndex+2:colonIndex+periodIndex]

#remove filler words/symbols
ingredientsOnly = ingredientsOnly.replace("*", "")
ingredientsOnly = ingredientsOnly.replace("\n", " ")
ingredientsOnly = ingredientsOnly.replace("â„¢", "")
ingredientsOnly = ingredientsOnly.replace(" and ", " ")

#split by commas
ingredientsList = ingredientsOnly.split(",")

#remove leading and trailing whitespace from each ingredient
ingredientsList = [ingredient.strip() for ingredient in ingredientsList]

for ingredient in ingredientsList:
    #match the ingredient to the database
    print("Ingredient: " + ingredient)